<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aser Company - Professional Website Design & Development</title>
  <meta name="description" content="Aser Company provides professional website design, custom web development, and maintenance services.">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Swiper -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>

  <!-- Firebase (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <style>
    :root{
      --primary:#6C63FF; --primaryDark:#554FD8;
      --accent:#36D1DC; --dark:#1A1C2E; --light:#F8F9FA;
      --gray:#6C757D; --border:#E9ECEF;
      --radius:18px;
      --shadow:0 14px 35px rgba(0,0,0,.12);
      --grad:linear-gradient(135deg,var(--primary),var(--accent));
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial, sans-serif}
    body{
      background: linear-gradient(-45deg, #6C63FF, #36D1DC, #FF6584, #1A1C2E);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color:#111;
      line-height:1.6;
      overflow-x:hidden;
      min-height:100vh;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ¨ÿ≥ŸäŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ© */
    .animated-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      pointer-events: none;
    }

    .animated-bg span {
      position: absolute;
      display: block;
      width: 20px;
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: float 25s linear infinite;
      bottom: -150px;
    }

    .animated-bg span:nth-child(1) {
      left: 25%;
      width: 80px;
      height: 80px;
      animation-delay: 0s;
      background: rgba(108, 99, 255, 0.2);
    }

    .animated-bg span:nth-child(2) {
      left: 10%;
      width: 40px;
      height: 40px;
      animation-delay: 2s;
      animation-duration: 12s;
      background: rgba(54, 209, 220, 0.2);
    }

    .animated-bg span:nth-child(3) {
      left: 70%;
      width: 100px;
      height: 100px;
      animation-delay: 4s;
      background: rgba(255, 101, 132, 0.15);
    }

    .animated-bg span:nth-child(4) {
      left: 40%;
      width: 60px;
      height: 60px;
      animation-delay: 0s;
      animation-duration: 18s;
      background: rgba(255, 255, 255, 0.1);
    }

    .animated-bg span:nth-child(5) {
      left: 65%;
      width: 50px;
      height: 50px;
      animation-delay: 0s;
      background: rgba(108, 99, 255, 0.15);
    }

    .animated-bg span:nth-child(6) {
      left: 85%;
      width: 110px;
      height: 110px;
      animation-delay: 3s;
      background: rgba(54, 209, 220, 0.1);
    }

    .animated-bg span:nth-child(7) {
      left: 50%;
      width: 90px;
      height: 90px;
      animation-delay: 7s;
      background: rgba(255, 101, 132, 0.2);
    }

    .animated-bg span:nth-child(8) {
      left: 15%;
      width: 70px;
      height: 70px;
      animation-delay: 5s;
      background: rgba(255, 255, 255, 0.1);
    }

    @keyframes float {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(-1000px) rotate(720deg);
        opacity: 0;
      }
    }

    a{color:inherit;text-decoration:none}

    .header{
      position:fixed;top:0;left:0;right:0;z-index:1000;
      background:rgba(255,255,255,.92);backdrop-filter: blur(14px);
      border-bottom:1px solid rgba(0,0,0,.05);
      padding:14px 5%;
    }
    .nav-container{max-width:1400px;margin:auto;display:flex;align-items:center;justify-content:space-between;gap:20px}
    .logo{display:flex;align-items:center;gap:12px}
    .logo-circle{
      width:48px;height:48px;border-radius:50%;
      background:white;border:3px solid var(--primary);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 8px 18px rgba(108,99,255,.18);
    }
    .logo-text{font-weight:900;font-size:22px;background:var(--grad);-webkit-background-clip:text;background-clip:text;color:transparent}
    .nav-links{display:flex;gap:18px;align-items:center}
    .nav-link{font-weight:700;color:#222;opacity:.9}
    .nav-link:hover{color:var(--primary)}
    .nav-cta{
      background:var(--grad);color:#fff;font-weight:800;
      padding:10px 18px;border-radius:999px;display:flex;gap:10px;align-items:center;
      box-shadow:0 10px 25px rgba(108,99,255,.25);
    }
    .main{padding-top:90px}

    .hero{
      margin:26px 5% 40px;
      border-radius:26px;
      background:rgba(255,255,255,0.1);
      backdrop-filter:blur(10px);
      color:white;
      padding:60px 18px;
      text-align:center;
      box-shadow:0 20px 45px rgba(0,0,0,.2);
      border:1px solid rgba(255,255,255,.1);
    }
    .hero h1{font-size:38px;margin-bottom:12px}
    .hero p{max-width:900px;margin:0 auto 18px;opacity:.95}
    .hero-actions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:10px}
    .btn{
      border:none;cursor:pointer;border-radius:14px;
      padding:12px 18px;font-weight:800;
      display:inline-flex;gap:10px;align-items:center;justify-content:center;
      transition:transform 0.3s, box-shadow 0.3s;
    }
    .btn:hover{transform:translateY(-3px);box-shadow:0 10px 25px rgba(0,0,0,.2)}
    .btn.white{background:#fff;color:var(--primary)}
    .btn.glass{background:rgba(255,255,255,.18);color:#fff;border:2px solid rgba(255,255,255,.5)}

    .section{padding:45px 5%}
    .section-title{font-size:28px;font-weight:900;margin-bottom:8px;color:white;text-shadow:0 2px 10px rgba(0,0,0,.2)}
    .section-sub{color:rgba(255,255,255,.8);margin-bottom:18px}

    .card{
      background:rgba(255,255,255,.95);
      backdrop-filter:blur(10px);
      border-radius:var(--radius);
      box-shadow:0 15px 40px rgba(0,0,0,.2);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.2);
      height:100%;display:flex;flex-direction:column;
      transition:transform 0.3s;
    }
    .card:hover{transform:translateY(-10px)}
    .card img{width:100%;height:180px;object-fit:cover}
    .card-body{padding:16px;display:flex;flex-direction:column;gap:10px;flex:1}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:var(--grad);color:#fff;font-weight:800;font-size:12px;width:max-content}
    .price{font-weight:900;color:var(--primary);font-size:18px}
    .stars{color:#f2c200;font-weight:800}
    .row{display:flex;justify-content:space-between;align-items:center;gap:10px}

    .swiper{padding:18px 10px 55px !important}
    .swiper-button-next,.swiper-button-prev{
      width:44px !important;height:44px !important;border-radius:50%;
      background:#fff;box-shadow:var(--shadow);color:var(--primary) !important;
      border:1px solid var(--border);
    }
    .swiper-button-next:after,.swiper-button-prev:after{font-size:18px !important}

    /* Modals */
    .modal{
      display:none;position:fixed;inset:0;z-index:2000;
      background:rgba(0,0,0,.85);backdrop-filter:blur(10px);
      align-items:center;justify-content:center;padding:18px;overflow:auto;
    }
    .modal-content{
      width:100%;max-width:1000px;background:#fff;border-radius:20px;overflow:hidden;
      box-shadow:0 35px 90px rgba(0,0,0,.5);
    }
    .modal-head{
      background:var(--dark);color:#fff;padding:16px 18px;
      display:flex;align-items:center;justify-content:space-between;gap:12px
    }
    .modal-head h3{font-size:18px}
    .close{width:42px;height:42px;border-radius:50%;border:1px solid rgba(255,255,255,.25);
      background:rgba(255,255,255,.12);color:#fff;cursor:pointer}
    .modal-body{padding:18px;background:#fff}

    .design-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .design-img{height:360px;border-radius:16px;overflow:hidden;box-shadow:var(--shadow)}
    .design-img img{width:100%;height:100%;object-fit:cover}
    .design-info{padding:6px}
    .design-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .action-link{
      flex:1;min-width:210px;
      padding:12px 14px;border-radius:12px;font-weight:900;
      display:inline-flex;gap:10px;align-items:center;justify-content:center;
      border:1px solid rgba(0,0,0,.08);background:#fff;cursor:pointer;
      transition:transform 0.3s;
    }
    .action-link:hover{transform:translateY(-3px)}
    .action-link.primary{background:var(--grad);color:#fff;border:none}
    .action-link.buy{background:#28a745;color:#fff;border:none}
    .action-link.secondary{background:#f1f3f5}
    .iframe-wrap{border-radius:14px;overflow:hidden;border:1px solid var(--border);box-shadow:var(--shadow)}
    .iframe-controls{display:flex;gap:10px;flex-wrap:wrap;padding:10px;background:#0f1220;color:#fff}
    .iframe-controls input{flex:1;min-width:230px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.08);color:#fff}
    .iframe-controls button,.iframe-controls a{
      padding:10px 12px;border-radius:10px;font-weight:800;border:1px solid rgba(255,255,255,.2);
      background:rgba(255,255,255,.08);color:#fff;cursor:pointer;display:inline-flex;gap:8px;align-items:center;justify-content:center;
      text-decoration:none;transition:background 0.3s;
    }
    .iframe-controls a.primary{background:var(--primary);border-color:var(--primary)}
    .iframe-controls a.primary:hover{background:var(--primaryDark)}
    iframe{width:100%;height:65vh;border:none;display:block}

    /* Admin (simple) */
    .admin-btn{
      position:fixed;right:18px;bottom:18px;z-index:1500;
      width:54px;height:54px;border-radius:50%;
      background:var(--grad);color:#fff;display:flex;align-items:center;justify-content:center;
      box-shadow:var(--shadow);cursor:pointer;border:3px solid #fff;
      animation:pulse 2s infinite;
    }
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}

    .admin-panel{
      display:none;position:fixed;inset:0;z-index:2100;background:rgba(0,0,0,.9);
      padding:18px;overflow:auto
    }
    .admin-box{
      max-width:1100px;margin:auto;background:var(--dark);color:#fff;border-radius:18px;
      box-shadow:0 35px 90px rgba(0,0,0,.6);padding:18px;border:1px solid rgba(255,255,255,.08)
    }
    .tabs{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
    .tab{padding:10px 14px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);color:#fff;font-weight:900;cursor:pointer}
    .tab.active{background:var(--grad);border-color:transparent}
    .panel{display:none}
    .panel.active{display:block}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .field label{display:block;margin-bottom:6px;font-weight:800;color:rgba(255,255,255,.85)}
    .field input,.field textarea,.field select{
      width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);color:#fff
    }
    .field textarea{min-height:90px}
    .save{margin-top:10px;width:100%;padding:12px;border-radius:12px;border:none;background:var(--primary);color:#fff;font-weight:900;cursor:pointer}
    .list{margin-top:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);border-radius:14px;padding:12px}
    .item{display:flex;justify-content:space-between;gap:12px;align-items:center;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,.08);margin-bottom:10px}
    .item:last-child{margin-bottom:0}
    .danger{background:#ff4444;border:none;color:#fff;padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:900}
    .success{background:#28a745;border:none;color:#fff;padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:900}

    /* Responsive */
    @media(max-width:900px){
      .nav-links{display:none}
      .hero h1{font-size:30px}
      .design-grid{grid-template-columns:1fr}
      .design-img{height:280px}
      .grid{grid-template-columns:1fr}
    }
  </style>
</head>

<body>
  <!-- ÿßŸÑÿÆŸÑŸÅŸäÿ© ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ© ÿßŸÑÿ¨ŸÖŸäŸÑÿ© -->
  <div class="animated-bg">
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
  </div>

  <!-- Header -->
  <header class="header" id="header">
    <div class="nav-container">
      <div class="logo">
        <div class="logo-circle"><i class="fas fa-laptop-code" style="color:var(--primary);font-size:20px"></i></div>
        <div class="logo-text">Aser</div>
      </div>
      <nav class="nav-links">
        <a class="nav-link" href="#home"><i class="fas fa-home"></i> Home</a>
        <a class="nav-link" href="#designs"><i class="fas fa-paint-brush"></i> Designs</a>
        <a class="nav-link" href="#services"><i class="fas fa-cogs"></i> Services</a>
        <a class="nav-link" href="#contact"><i class="fas fa-envelope"></i> Contact</a>
      </nav>
      <a class="nav-cta" href="#contact"><i class="fas fa-rocket"></i> Get Started</a>
    </div>
  </header>

  <main class="main" id="home">
    <!-- Hero -->
    <section class="hero">
      <h1>Aser Company - Professional Website Design</h1>
      <p>Custom, high-performance websites for businesses and individuals. Landing pages, portfolios, e-commerce, and more.</p>
      <div class="hero-actions">
        <a class="btn white" href="#designs"><i class="fas fa-eye"></i> View Portfolio</a>
        <a class="btn glass" href="#services"><i class="fas fa-cogs"></i> Our Services</a>
      </div>
    </section>

    <!-- Designs -->
    <section class="section" id="designs">
      <div class="section-title">Latest Website Designs</div>
      <div class="section-sub">Explore our recent projects and custom website solutions</div>

      <div class="swiper designsSwiper">
        <div class="swiper-wrapper" id="designsContainer"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-pagination"></div>
      </div>
    </section>

    <!-- Services / Order -->
    <section class="section" id="services">
      <div class="section-title">Our Web Design Services</div>
      <div class="section-sub">Select services then submit inquiry</div>

      <div style="background:rgba(255,255,255,.95);backdrop-filter:blur(10px);border-radius:18px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,.2);padding:16px">
        <div id="servicesGrid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px"></div>

        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:14px">
          <div>
            <label style="font-weight:900">Full Name *</label>
            <input id="clientName" style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);margin-top:6px" placeholder="Enter your full name">
          </div>
          <div>
            <label style="font-weight:900">Phone Number *</label>
            <input id="clientPhone" style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);margin-top:6px" placeholder="Enter your phone number">
          </div>
        </div>

        <div style="margin-top:12px">
          <label style="font-weight:900">Additional Details (Optional)</label>
          <textarea id="orderDetails" style="width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);margin-top:6px;min-height:90px" placeholder="Add any details..."></textarea>
        </div>

        <div style="margin-top:14px;background:var(--light);border:1px solid var(--border);border-radius:14px;padding:14px">
          <div style="font-weight:900;margin-bottom:10px">Order Summary</div>
          <div class="row"><span>Selected Services:</span><strong id="servicesCount">0</strong></div>
          <div class="row"><span>Subtotal:</span><strong id="totalPrice">$0</strong></div>
          <div class="row" id="discountItem" style="display:none"><span>Discount:</span><strong id="discountAmount" style="color:#28a745">$0</strong></div>
          <div class="row" style="margin-top:6px"><span>Total:</span><strong id="finalPrice">$0</strong></div>
          <div id="discountNote" style="display:none;margin-top:10px;background:#fff3cd;border:1px solid #ffeaa7;padding:10px;border-radius:12px;color:#856404;font-weight:800">
            üéâ 10% discount if you select more than 3 services.
          </div>
        </div>

        <button id="sendOrderBtn" class="btn" style="margin-top:12px;width:100%;background:var(--primary);color:#fff" disabled>
          <i class="fas fa-paper-plane"></i> Submit Inquiry
        </button>
      </div>
    </section>

    <!-- Contact -->
    <section class="section" id="contact">
      <div class="section-title">Contact Us</div>
      <div class="section-sub">We are here to help you achieve your digital goals.</div>

      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px">
        <div class="card" style="padding:16px">
          <div class="row"><strong><i class="fas fa-phone-alt"></i> Phone</strong></div>
          <div style="color:var(--gray);margin-top:6px">+971 54 521 6539 (UAE)</div>
        </div>
        <div class="card" style="padding:16px">
          <div class="row"><strong><i class="fas fa-envelope"></i> Email</strong></div>
          <div style="color:var(--gray);margin-top:6px">mostafa332004a@gmail.com</div>
        </div>
        <div class="card" style="padding:16px">
          <div class="row"><strong><i class="fas fa-clock"></i> Working Hours</strong></div>
          <div style="color:var(--gray);margin-top:6px">Mon-Fri: 9AM - 6PM (GMT+4)</div>
        </div>
      </div>
    </section>
  </main>

  <!-- Design Modal -->
  <div id="designModal" class="modal">
    <div class="modal-content">
      <div class="modal-head">
        <div>
          <h3 id="designModalTitle">Design</h3>
          <div id="designModalCategory" style="opacity:.8;font-weight:800;font-size:13px;margin-top:2px"></div>
        </div>
        <button class="close" onclick="closeDesignModal()"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" id="designModalBody"></div>
    </div>
  </div>

  <!-- Admin Button -->
  <div class="admin-btn" onclick="showAdmin()"><i class="fas fa-cog"></i></div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="admin-panel">
    <div class="admin-box">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
        <h2 style="margin:0">Admin Panel</h2>
        <button class="danger" onclick="hideAdmin()"><i class="fas fa-times"></i> Close</button>
      </div>

      <div class="tabs" style="margin-top:12px">
        <button class="tab active" onclick="switchTab('designs', event)"><i class="fas fa-paint-brush"></i> Designs</button>
        <button class="tab" onclick="switchTab('services', event)"><i class="fas fa-cogs"></i> Services</button>
        <button class="tab" onclick="switchTab('orders', event)"><i class="fas fa-shopping-cart"></i> Orders</button>
        <button class="tab" onclick="switchTab('complaints', event)"><i class="fas fa-exclamation-triangle"></i> Complaints</button>
        <button class="tab" onclick="exportData()"><i class="fas fa-download"></i> Export</button>
        <button class="tab" onclick="importData()"><i class="fas fa-upload"></i> Import</button>
      </div>

      <!-- Designs Admin -->
      <div id="tab-designs" class="panel active">
        <div class="grid">
          <div class="field">
            <label>Title</label>
            <input id="designTitle" placeholder="Design title">
          </div>
          <div class="field">
            <label>Category</label>
            <select id="designCategory">
              <option value="E-commerce Website">E-commerce Website</option>
              <option value="Company Website">Company Website</option>
              <option value="Personal Website">Personal Website</option>
            </select>
          </div>
          <div class="field">
            <label>Image URL</label>
            <input id="designImage" placeholder="https://...">
          </div>
          <div class="field">
            <label>Website Link</label>
            <input id="designLink" placeholder="https://...">
          </div>
          <div class="field">
            <label>Price ($)</label>
            <input id="designPrice" type="number" value="299">
          </div>
          <div class="field" style="grid-column:1/-1">
            <label>Description</label>
            <textarea id="designDescription" placeholder="Design description"></textarea>
          </div>
        </div>
        <button class="save" onclick="addDesignAdmin()"><i class="fas fa-plus"></i> Add Design</button>
        <div class="list" id="designsList"></div>
      </div>

      <!-- Services Admin -->
      <div id="tab-services" class="panel">
        <div class="grid">
          <div class="field">
            <label>Name</label>
            <input id="serviceName" placeholder="Service name">
          </div>
          <div class="field">
            <label>Icon</label>
            <select id="serviceIcon">
              <option value="fas fa-paint-brush">Design</option>
              <option value="fas fa-code">Development</option>
              <option value="fas fa-shopping-cart">E-commerce</option>
              <option value="fas fa-user">Personal</option>
            </select>
          </div>
          <div class="field">
            <label>Price ($)</label>
            <input id="servicePriceUSD" type="number" value="299">
          </div>
          <div class="field" style="grid-column:1/-1">
            <label>Description</label>
            <textarea id="serviceDescription" placeholder="Service description"></textarea>
          </div>
        </div>
        <button class="save" onclick="addServiceAdmin()"><i class="fas fa-plus"></i> Add Service</button>
        <div class="list" id="servicesList"></div>
      </div>

      <!-- Orders -->
      <div id="tab-orders" class="panel">
        <div class="list" id="ordersList"></div>
      </div>

      <!-- Complaints -->
      <div id="tab-complaints" class="panel">
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px">
          <button class="tab" style="min-width:auto" onclick="addTestComplaint()"><i class="fas fa-plus"></i> Add Test Complaint</button>
        </div>
        <div class="list" id="complaintsList"></div>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
  <script>
    // ==============================
    // CONFIG
    // ==============================
    const SYSTEM_CONFIG = {
      appName: "Aser",
      version: "4.0",
      adminPassword: "332004",
      firebaseConfig: {
        apiKey: "AIzaSyCkign3vnAZ6X1cCaAUvN3cVUaGpIigGNQ",
        authDomain: "mostafaaser-b0053.firebaseapp.com",
        databaseURL: "https://mostafaaser-b0053-default-rtdb.firebaseio.com",
        projectId: "mostafaaser-b0053",
        storageBucket: "mostafaaser-b0053.firebasestorage.app",
        messagingSenderId: "336529119748",
        appId: "1:336529119748:web:6d02cee38c7965bda8f351"
      },
      autoRefresh: 20000
    };

    // ==============================
    // HELPERS
    // ==============================
    function normalizeUrl(raw) {
      let url = (raw || '').trim();
      url = url.split(/\s+/)[0];
      if (!url) return '';
      if (!/^https?:\/\//i.test(url)) url = 'https://' + url;
      if (/^(javascript|data):/i.test(url)) return '';
      try {
        const u = new URL(url);
        return u.toString();
      } catch (e) {
        return encodeURI(url);
      }
    }

    function escapeHTML(str='') {
      return String(str).replace(/[&<>"']/g, m => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
      }[m]));
    }

    // ==============================
    // DATA
    // ==============================
    let globalData = {
      designs: [
        {
          id: 1,
          title: "Professional Company Website",
          category: "Company Website",
          image: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=1200",
          rating: 4.6,
          description: "Professional company website",
          price: 499,
          link: "https://example.com"
        },
        {
          id: 2,
          title: "Complete E-commerce Website",
          category: "E-commerce Website",
          image: "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=1200",
          rating: 4.8,
          description: "Complete e-commerce store with dashboard",
          price: 299,
          link: "https://example.com"
        }
      ],
      services: [
        { id: 1, name: "Company Website Design", icon: "fas fa-paint-brush", description: "Professional company website", priceUSD: 299 },
        { id: 2, name: "E-commerce Store", icon: "fas fa-shopping-cart", description: "Complete e-commerce store", priceUSD: 499 },
        { id: 3, name: "Personal Website", icon: "fas fa-user", description: "Personal portfolio", priceUSD: 199 }
      ],
      orders: [],
      complaints: [],
      lastUpdated: new Date().toISOString(),
      syncId: 'sync_' + Date.now()
    };

    let firebaseApp = null;
    let firebaseDatabase = null;
    let isFirebaseReady = false;
    let designsSwiper = null;
    let selectedServices = [];
    let isSyncing = false;
    let autoSyncInterval = null;

    // ==============================
    // FIREBASE
    // ==============================
    function initFirebase() {
      try {
        if (typeof firebase !== 'undefined') {
          if (!firebase.apps.length) firebaseApp = firebase.initializeApp(SYSTEM_CONFIG.firebaseConfig);
          else firebaseApp = firebase.app();
          firebaseDatabase = firebase.database();
          isFirebaseReady = true;
          listenForUpdates();
          return true;
        }
      } catch (e) {}
      return false;
    }

    function listenForUpdates() {
      if (!isFirebaseReady) return;
      firebaseDatabase.ref('asir_data').on('value', (snap) => {
        const data = snap.val();
        if (data && data.syncId !== globalData.syncId) {
          globalData = data;
          localStorage.setItem('asir_global_data', JSON.stringify(globalData));
          updateUI();
          updateAdminLists();
        }
      });
    }

    async function saveGlobalData() {
      if (isSyncing) return;
      isSyncing = true;
      try {
        globalData.lastUpdated = new Date().toISOString();
        globalData.syncId = 'sync_' + Date.now() + '_' + Math.random().toString(36).slice(2,8);
        localStorage.setItem('asir_global_data', JSON.stringify(globalData));

        if (isFirebaseReady && navigator.onLine) {
          await firebaseDatabase.ref('asir_data').set(globalData);
        }
      } catch (e) {
      } finally {
        isSyncing = false;
      }
    }

    async function loadGlobalData(force=false) {
      if (isSyncing && !force) return;
      isSyncing = true;
      try {
        if (isFirebaseReady && navigator.onLine) {
          const snap = await firebaseDatabase.ref('asir_data').once('value');
          if (snap.exists()) {
            const dbData = snap.val();
            if (force || !globalData.lastUpdated || new Date(dbData.lastUpdated) > new Date(globalData.lastUpdated)) {
              globalData = dbData;
              localStorage.setItem('asir_global_data', JSON.stringify(globalData));
            }
          }
        } else {
          const local = localStorage.getItem('asir_global_data');
          if (local) globalData = JSON.parse(local);
        }
      } catch (e) {
      } finally {
        isSyncing = false;
      }
    }

    function startAutoSync() {
      if (autoSyncInterval) clearInterval(autoSyncInterval);
      autoSyncInterval = setInterval(() => {
        if (!isSyncing && navigator.onLine && isFirebaseReady) loadGlobalData();
      }, SYSTEM_CONFIG.autoRefresh);
    }

    // ==============================
    // UI - Designs
    // ==============================
    function renderDesigns() {
      const container = document.getElementById('designsContainer');
      if (!container) return;

      container.innerHTML = globalData.designs.map(d => {
        const stars = '‚òÖ'.repeat(Math.floor(d.rating||0)) + '‚òÜ'.repeat(5 - Math.floor(d.rating||0));
        const img = escapeHTML(d.image || '');
        return `
          <div class="swiper-slide">
            <div class="card">
              <img src="${img}" onerror="this.src='https://images.unsplash.com/photo-1551650975-87deedd944c3?w=1200'">
              <div class="card-body">
                <span class="pill">${escapeHTML(d.category||'')}</span>
                <div style="font-weight:900;font-size:16px">${escapeHTML(d.title||'')}</div>
                <div style="color:var(--gray)">${escapeHTML(d.description||'')}</div>
                <button class="btn" style="background:var(--primary);color:#fff" onclick="openDesignModal(${d.id})">
                  <i class="fas fa-eye"></i> View Details
                </button>
                <div class="row">
                  <div class="price">$${Number(d.price||0)}</div>
                  <div class="stars">${stars} ${Number(d.rating||0)}</div>
                </div>
              </div>
            </div>
          </div>
        `;
      }).join('');

      if (designsSwiper) designsSwiper.update();
    }

    function openDesignModal(id) {
      const design = globalData.designs.find(x => x.id === id);
      if (!design) return;

      const safeLink = normalizeUrl(design.link);
      const stars = '‚òÖ'.repeat(Math.floor(design.rating||0)) + '‚òÜ'.repeat(5 - Math.floor(design.rating||0));

      document.getElementById('designModalTitle').textContent = design.title || 'Design';
      document.getElementById('designModalCategory').textContent = design.category || '';

      let actionsHtml = '';
      if (safeLink) {
        actionsHtml = `
          <a class="action-link primary"
             href="${safeLink}"
             target="_blank"
             rel="noopener noreferrer">
            <i class="fas fa-external-link-alt"></i> Open Website (New Tab)
          </a>

          <button class="action-link secondary" onclick="openDesignInFrame('${safeLink.replace(/'/g,"\\'")}')">
            <i class="fas fa-eye"></i> Preview Here (iframe)
          </button>
        `;
      } else {
        actionsHtml = `<div style="padding:12px;border-radius:12px;background:#fff3cd;border:1px solid #ffeaa7;color:#856404;font-weight:900">
          ‚ö†Ô∏è Invalid or missing link for this design.
        </div>`;
      }

      document.getElementById('designModalBody').innerHTML = `
        <div class="design-grid">
          <div class="design-img">
            <img src="${escapeHTML(design.image||'')}"
                 onerror="this.src='https://images.unsplash.com/photo-1551650975-87deedd944c3?w=1200'">
          </div>
          <div class="design-info">
            <div class="pill">${escapeHTML(design.category||'')}</div>
            <div style="margin-top:10px;font-weight:900;font-size:22px;color:var(--primary)">$${Number(design.price||0)}</div>
            <div style="margin-top:6px" class="stars">${stars} ${Number(design.rating||0)}</div>
            <div style="margin-top:10px;color:var(--gray)">${escapeHTML(design.description||'')}</div>

            <div class="design-actions">
              ${actionsHtml}
              <button class="action-link buy" onclick="buyNow(${design.id})">
                <i class="fas fa-shopping-cart"></i> Buy Now
              </button>
            </div>
          </div>
        </div>
      `;

      document.getElementById('designModal').style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeDesignModal() {
      document.getElementById('designModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function openDesignInFrame(url) {
      const safeUrl = normalizeUrl(url);
      if (!safeUrl) return alert('Invalid URL');

      const body = document.getElementById('designModalBody');
      const previous = body.innerHTML;

      body.innerHTML = `
        <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:10px">
          <button class="action-link secondary" style="min-width:auto" onclick="goBackToDesignView()">
            <i class="fas fa-arrow-left"></i> Back
          </button>

          <a class="action-link primary" style="min-width:auto"
             href="${safeUrl}" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-external-link-alt"></i> Open New Tab
          </a>
        </div>

        <div class="iframe-wrap">
          <div class="iframe-controls">
            <input id="designFrameUrl" value="${safeUrl}" />
            <button onclick="navigateDesignFrame()"><i class="fas fa-location-arrow"></i> Go</button>
            <button onclick="reloadDesignFrame()"><i class="fas fa-redo"></i></button>
            <a class="primary" href="${safeUrl}" target="_blank" rel="noopener noreferrer">
              <i class="fas fa-external-link-alt"></i> New Tab
            </a>
          </div>
          <iframe id="designFrame" src="${safeUrl}"></iframe>
        </div>

        <div style="margin-top:10px;background:#fff3cd;border:1px solid #ffeaa7;padding:10px;border-radius:12px;color:#856404;font-weight:900">
          ‚ö†Ô∏è Some websites block iframe preview. If preview doesn't load, use "Open New Tab".
        </div>
      `;
    }

    function goBackToDesignView() {
      const designId = parseInt(document.getElementById('designModalTitle')?.dataset?.id) || null;
      if (designId) {
        openDesignModal(designId);
      } else {
        location.reload();
      }
    }

    function reloadDesignFrame() {
      const f = document.getElementById('designFrame');
      if (f) f.src = f.src;
    }

    function navigateDesignFrame() {
      const input = document.getElementById('designFrameUrl');
      const frame = document.getElementById('designFrame');
      if (!input || !frame) return;
      const safeUrl = normalizeUrl(input.value);
      if (!safeUrl) return alert('Invalid URL');
      input.value = safeUrl;
      frame.src = safeUrl;
    }

    function buyNow(id) {
      const design = globalData.designs.find(d => d.id === id);
      if (design) {
        alert(`üõí You selected: ${design.title} - $${design.price}\nWe'll contact you soon!`);
      }
    }

    // ==============================
    // UI - Services / Orders
    // ==============================
    function renderServices() {
      const grid = document.getElementById('servicesGrid');
      if (!grid) return;

      grid.innerHTML = globalData.services.map(s => {
        const sel = selectedServices.includes(s.id);
        return `
          <div class="card" onclick="toggleService(${s.id})" style="cursor:pointer; border:2px solid ${sel ? 'var(--primary)' : 'rgba(0,0,0,.04)'}">
            <div class="card-body">
              <div class="row">
                <div style="font-weight:900"><i class="${escapeHTML(s.icon||'fas fa-cog')}"></i> ${escapeHTML(s.name||'')}</div>
                <div class="price">$${Number(s.priceUSD||0)}</div>
              </div>
              <div style="color:var(--gray)">${escapeHTML(s.description||'')}</div>
              <div style="font-weight:900;color:${sel ? 'var(--primary)' : '#111'}">${sel ? 'Selected ‚úÖ' : 'Click to select'}</div>
            </div>
          </div>
        `;
      }).join('');
    }

    function toggleService(id) {
      const idx = selectedServices.indexOf(id);
      if (idx === -1) selectedServices.push(id);
      else selectedServices.splice(idx, 1);
      renderServices();
      updateOrderSummary();
    }

    function updateOrderSummary() {
      let total = 0;
      selectedServices.forEach(id => {
        const s = globalData.services.find(x => x.id === id);
        if (s) total += Number(s.priceUSD||0);
      });
      const discount = selectedServices.length > 3 ? total * 0.1 : 0;
      const final = total - discount;

      document.getElementById('servicesCount').textContent = selectedServices.length;
      document.getElementById('totalPrice').textContent = `$${total}`;
      document.getElementById('discountAmount').textContent = `$${discount.toFixed(2)}`;
      document.getElementById('finalPrice').textContent = `$${final.toFixed(2)}`;

      document.getElementById('discountItem').style.display = selectedServices.length > 3 ? 'flex' : 'none';
      document.getElementById('discountNote').style.display = selectedServices.length > 3 ? 'block' : 'none';

      updateSendButton();
    }

    function updateSendButton() {
      const name = (document.getElementById('clientName')?.value || '').trim();
      const phone = (document.getElementById('clientPhone')?.value || '').trim();
      document.getElementById('sendOrderBtn').disabled = !(selectedServices.length && name && phone);
    }

    function sendOrder() {
      const name = (document.getElementById('clientName').value || '').trim();
      const phone = (document.getElementById('clientPhone').value || '').trim();
      const details = (document.getElementById('orderDetails').value || '').trim();
      if (!name || !phone || !selectedServices.length) return alert('Fill required fields and select services.');

      let total = 0;
      const services = selectedServices.map(id => {
        const s = globalData.services.find(x => x.id === id);
        total += Number(s?.priceUSD||0);
        return { id, name: s?.name || '', price: Number(s?.priceUSD||0) };
      });

      const discount = selectedServices.length > 3 ? total * 0.1 : 0;
      const order = {
        id: 'ORD_' + Date.now(),
        customerName: name,
        phone,
        details,
        services,
        total,
        discount,
        finalTotal: total - discount,
        status: 'new',
        createdAt: new Date().toISOString()
      };

      globalData.orders.unshift(order);
      saveGlobalData();

      alert('‚úÖ Order submitted!');
      selectedServices = [];
      document.getElementById('clientName').value = '';
      document.getElementById('clientPhone').value = '';
      document.getElementById('orderDetails').value = '';
      renderServices();
      updateOrderSummary();
      updateAdminLists();
    }

    // ==============================
    // ADMIN
    // ==============================
    function showAdmin() {
      const pwd = prompt("Enter admin password:");
      if (!pwd) return;
      if (pwd !== SYSTEM_CONFIG.adminPassword) return alert("Wrong password");
      document.getElementById('adminPanel').style.display = 'block';
      document.body.style.overflow = 'hidden';
      updateAdminLists();
    }
    function hideAdmin() {
      document.getElementById('adminPanel').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    function switchTab(name, ev) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.getElementById('tab-' + name).classList.add('active');
      ev.target.closest('.tab').classList.add('active');
      updateAdminLists();
    }

    function updateAdminLists() {
      // Designs list
      const dList = document.getElementById('designsList');
      dList.innerHTML = globalData.designs.map(d => `
        <div class="item">
          <div>
            <div style="font-weight:900">${escapeHTML(d.title||'')}</div>
            <div style="opacity:.8">${escapeHTML(d.category||'')} ‚Ä¢ $${Number(d.price||0)}</div>
            <div style="opacity:.8;font-size:12px">Link: ${escapeHTML(normalizeUrl(d.link)||'')}</div>
          </div>
          <button class="danger" onclick="deleteDesignAdmin(${d.id})"><i class="fas fa-trash"></i></button>
        </div>
      `).join('') || '<div style="text-align:center;opacity:.8;padding:10px">No designs</div>';

      // Services list
      const sList = document.getElementById('servicesList');
      sList.innerHTML = globalData.services.map(s => `
        <div class="item">
          <div>
            <div style="font-weight:900">${escapeHTML(s.name||'')}</div>
            <div style="opacity:.8">$${Number(s.priceUSD||0)} ‚Ä¢ ${escapeHTML(s.description||'')}</div>
          </div>
          <button class="danger" onclick="deleteServiceAdmin(${s.id})"><i class="fas fa-trash"></i></button>
        </div>
      `).join('') || '<div style="text-align:center;opacity:.8;padding:10px">No services</div>';

      // Orders
      const oList = document.getElementById('ordersList');
      oList.innerHTML = (globalData.orders||[]).map(o => `
        <div class="item" style="align-items:flex-start">
          <div>
            <div style="font-weight:900">${escapeHTML(o.customerName||'')}</div>
            <div style="opacity:.8">üìû ${escapeHTML(o.phone||'')}</div>
            <div style="opacity:.8">Total: $${Number(o.finalTotal||0).toFixed(2)}</div>
            <div style="opacity:.6;font-size:12px">${new Date(o.createdAt).toLocaleString()}</div>
          </div>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="success" onclick="deleteOrderAdmin('${o.id}')"><i class="fas fa-check"></i> Done</button>
            <button class="danger" onclick="deleteOrderAdmin('${o.id}')"><i class="fas fa-trash"></i></button>
          </div>
        </div>
      `).join('') || '<div style="text-align:center;opacity:.8;padding:10px">No orders</div>';

      // Complaints
      const cList = document.getElementById('complaintsList');
      cList.innerHTML = (globalData.complaints||[]).map(c => `
        <div class="item" style="align-items:flex-start">
          <div>
            <div style="font-weight:900">${escapeHTML(c.customerName||'')}</div>
            <div style="opacity:.8">üìû ${escapeHTML(c.contact||'')}</div>
            <div style="opacity:.8">${escapeHTML(c.details||'')}</div>
            <div style="opacity:.6;font-size:12px">${new Date(c.createdAt).toLocaleString()}</div>
          </div>
          <button class="danger" onclick="deleteComplaintAdmin('${c.id}')"><i class="fas fa-trash"></i></button>
        </div>
      `).join('') || '<div style="text-align:center;opacity:.8;padding:10px">No complaints</div>';
    }

    function addDesignAdmin() {
      const title = (document.getElementById('designTitle').value||'').trim();
      const category = document.getElementById('designCategory').value;
      const image = (document.getElementById('designImage').value||'').trim();
      const linkRaw = (document.getElementById('designLink').value||'');
      const link = normalizeUrl(linkRaw) || '#';
      const price = Number(document.getElementById('designPrice').value||0);
      const description = (document.getElementById('designDescription').value||'').trim();

      if (!title || !image) return alert('Title and Image URL are required');

      globalData.designs.unshift({
        id: Date.now(),
        title, category, image, link,
        price, description: description || 'No description',
        rating: 4.5
      });

      saveGlobalData();
      renderDesigns();
      updateAdminLists();

      document.getElementById('designTitle').value='';
      document.getElementById('designImage').value='';
      document.getElementById('designLink').value='';
      document.getElementById('designDescription').value='';
    }

    function deleteDesignAdmin(id) {
      if (!confirm('Delete design?')) return;
      globalData.designs = globalData.designs.filter(d => d.id !== id);
      saveGlobalData();
      renderDesigns();
      updateAdminLists();
    }

    function addServiceAdmin() {
      const name = (document.getElementById('serviceName').value||'').trim();
      const icon = document.getElementById('serviceIcon').value;
      const priceUSD = Number(document.getElementById('servicePriceUSD').value||0);
      const description = (document.getElementById('serviceDescription').value||'').trim();

      if (!name) return alert('Service name required');

      globalData.services.unshift({ id: Date.now(), name, icon, priceUSD, description: description||'No description' });
      saveGlobalData();
      renderServices();
      updateAdminLists();

      document.getElementById('serviceName').value='';
      document.getElementById('serviceDescription').value='';
    }

    function deleteServiceAdmin(id) {
      if (!confirm('Delete service?')) return;
      globalData.services = globalData.services.filter(s => s.id !== id);
      saveGlobalData();
      renderServices();
      updateAdminLists();
    }

    function deleteOrderAdmin(id) {
      if (!confirm('Delete order?')) return;
      globalData.orders = globalData.orders.filter(o => o.id !== id);
      saveGlobalData();
      updateAdminLists();
    }

    function addTestComplaint() {
      globalData.complaints.unshift({
        id: 'CMP_' + Date.now(),
        customerName: "Test User",
        contact: "test@email.com",
        details: "Test complaint message",
        createdAt: new Date().toISOString()
      });
      saveGlobalData();
      updateAdminLists();
    }

    function deleteComplaintAdmin(id) {
      if (!confirm('Delete complaint?')) return;
      globalData.complaints = globalData.complaints.filter(c => c.id !== id);
      saveGlobalData();
      updateAdminLists();
    }

    function exportData() {
      const dataStr = JSON.stringify(globalData, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `aser-backup-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      alert('‚úÖ Data exported successfully');
    }

    function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';

      input.onchange = function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();

        reader.onload = function(e) {
          try {
            const imported = JSON.parse(e.target.result);
            if (imported.designs && imported.services) {
              globalData = imported;
              saveGlobalData();
              updateUI();
              updateAdminLists();
              alert('‚úÖ Data imported successfully');
            } else {
              alert('‚ùå Invalid file');
            }
          } catch {
            alert('‚ùå Error reading file');
          }
        };

        reader.readAsText(file);
      };

      input.click();
    }

    // ==============================
    // INIT
    // ==============================
    function updateUI() {
      renderDesigns();
      renderServices();
      updateOrderSummary();
    }

    function initApp() {
      // load local first
      const local = localStorage.getItem('asir_global_data');
      if (local) {
        try { globalData = JSON.parse(local); } catch(e){}
      }

      initFirebase();
      loadGlobalData(true).then(() => {
        updateUI();

        designsSwiper = new Swiper('.designsSwiper', {
          slidesPerView: 1,
          spaceBetween: 18,
          loop: true,
          pagination: { el: '.swiper-pagination', clickable: true },
          navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
          breakpoints: { 768: { slidesPerView: 2 }, 1024: { slidesPerView: 3 } }
        });

        startAutoSync();
      });

      // Events
      document.getElementById('clientName').addEventListener('input', updateSendButton);
      document.getElementById('clientPhone').addEventListener('input', updateSendButton);
      document.getElementById('sendOrderBtn').addEventListener('click', sendOrder);

      // Smooth scroll
      document.querySelectorAll('a[href^="#"]').forEach(a => {
        a.addEventListener('click', e => {
          const target = document.querySelector(a.getAttribute('href'));
          if (!target) return;
          e.preventDefault();
          window.scrollTo({ top: target.offsetTop - 70, behavior: 'smooth' });
        });
      });

      // Close design modal by clicking outside
      document.getElementById('designModal').addEventListener('click', (e) => {
        if (e.target.id === 'designModal') closeDesignModal();
      });
    }

    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>
